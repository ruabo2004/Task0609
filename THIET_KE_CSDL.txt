â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    Há»† THá»NG QUáº¢N LÃ HOMESTAY - THIáº¾T Káº¾ CÆ  Sá» Dá»® LIá»†U
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ Má»¤C Lá»¤C
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Tá»•ng quan Database
2. SÆ¡ Ä‘á»“ quan há»‡ thá»±c thá»ƒ (ERD)
3. Chi tiáº¿t cÃ¡c báº£ng (Tables)
4. Má»‘i quan há»‡ (Relationships)
5. Indexes vÃ  Constraints
6. Views (CÃ¡c khung nhÃ¬n)
7. Stored Procedures
8. Triggers
9. Queries quan trá»ng
10. Optimization vÃ  Best Practices

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. Tá»”NG QUAN DATABASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ—„ï¸ ThÃ´ng tin cÆ¡ báº£n:
   - Database Name: homestay_db
   - DBMS: MySQL 8.0+
   - Character Set: utf8mb4
   - Collation: utf8mb4_unicode_ci
   - Engine: InnoDB
   - Total Tables: 11

ğŸ“Š Danh sÃ¡ch cÃ¡c báº£ng:
   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ #  â”‚ TÃŠN Báº¢NG           â”‚ MÃ” Táº¢                                       â”‚
   â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ 1  â”‚ users              â”‚ ThÃ´ng tin ngÆ°á»i dÃ¹ng (Customer/Staff/Admin) â”‚
   â”‚ 2  â”‚ rooms              â”‚ ThÃ´ng tin phÃ²ng                             â”‚
   â”‚ 3  â”‚ bookings           â”‚ ÄÆ¡n Ä‘áº·t phÃ²ng                               â”‚
   â”‚ 4  â”‚ payments           â”‚ Thanh toÃ¡n                                  â”‚
   â”‚ 5  â”‚ services           â”‚ Dá»‹ch vá»¥ bá»• sung                             â”‚
   â”‚ 6  â”‚ booking_services   â”‚ Dá»‹ch vá»¥ kÃ¨m booking (báº£ng trung gian)       â”‚
   â”‚ 7  â”‚ reviews            â”‚ ÄÃ¡nh giÃ¡ cá»§a khÃ¡ch hÃ ng                     â”‚
   â”‚ 8  â”‚ staff_reports      â”‚ BÃ¡o cÃ¡o cÃ´ng viá»‡c cá»§a nhÃ¢n viÃªn             â”‚
   â”‚ 9  â”‚ staff_profiles     â”‚ Há»“ sÆ¡ nhÃ¢n viÃªn chi tiáº¿t                    â”‚
   â”‚ 10 â”‚ work_shifts        â”‚ Ca lÃ m viá»‡c                                 â”‚
   â”‚ 11 â”‚ attendance_logs    â”‚ Cháº¥m cÃ´ng                                   â”‚
   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ˆ Thá»‘ng kÃª:
   - Tá»•ng sá»‘ Foreign Keys: 15
   - Tá»•ng sá»‘ Indexes: 60+
   - Tá»•ng sá»‘ Views: 3
   - Tá»•ng sá»‘ Triggers: 2
   - Tá»•ng sá»‘ Stored Procedures: 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. SÆ  Äá»’ QUAN Há»† THá»°C THá»‚ (ERD)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ER DIAGRAM (ASCII ART)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚      USERS       â”‚
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â”‚ PK id            â”‚
                            â”‚    email         â”‚
                            â”‚    password      â”‚
                            â”‚    full_name     â”‚
                            â”‚    phone         â”‚
                            â”‚    role          â”‚
                            â”‚    id_number     â”‚
                            â”‚    ...           â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                   â”‚                   â”‚
                 â”‚                   â”‚                   â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
          â”‚  BOOKINGS   â”‚    â”‚   REVIEWS   â”‚    â”‚ STAFF_      â”‚
          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚ PROFILES    â”‚
          â”‚ PK id       â”‚    â”‚ PK id       â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
          â”‚ FK user_id  â”‚â—„â”€â”€â”€â”¤ FK user_id  â”‚    â”‚ PK id       â”‚
          â”‚ FK room_id  â”‚    â”‚ FK booking_ â”‚    â”‚ FK user_id  â”‚
          â”‚    check_in â”‚    â”‚    id       â”‚    â”‚    position â”‚
          â”‚    check_   â”‚    â”‚    rating   â”‚    â”‚    hire_    â”‚
          â”‚    out      â”‚    â”‚    comment  â”‚    â”‚    date     â”‚
          â”‚    status   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚    ...      â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PAYMENTS â”‚ â”‚BOOKING_    â”‚ â”‚    ROOMS      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚SERVICES    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id   â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ PK id         â”‚
â”‚ FK book â”‚ â”‚ PK id      â”‚ â”‚    room_      â”‚
â”‚    ing_ â”‚ â”‚ FK booking â”‚ â”‚    number     â”‚
â”‚    id   â”‚ â”‚    _id     â”‚ â”‚    room_type  â”‚
â”‚ amount  â”‚ â”‚ FK service â”‚ â”‚    capacity   â”‚
â”‚ method  â”‚ â”‚    _id     â”‚ â”‚    price_per_ â”‚
â”‚ status  â”‚ â”‚ quantity   â”‚ â”‚    night      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ price      â”‚ â”‚    status     â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    amenities  â”‚
                 â”‚         â”‚    images     â”‚
            â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚SERVICES  â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ PK id    â”‚
            â”‚ name     â”‚
            â”‚ price    â”‚
            â”‚ category â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CARDINALITY (Quan há»‡ sá»‘ lÆ°á»£ng)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

users â”€â”€â”€â”€â”€(1:N)â”€â”€â”€â”€â”€â”€ bookings
   â”‚ Má»™t user cÃ³ thá»ƒ cÃ³ nhiá»u bookings
   â”‚ Má»™t booking chá»‰ thuá»™c vá» má»™t user

users â”€â”€â”€â”€â”€(1:N)â”€â”€â”€â”€â”€â”€ reviews
   â”‚ Má»™t user cÃ³ thá»ƒ viáº¿t nhiá»u reviews
   â”‚ Má»™t review chá»‰ thuá»™c vá» má»™t user

rooms â”€â”€â”€â”€â”€(1:N)â”€â”€â”€â”€â”€â”€ bookings
   â”‚ Má»™t room cÃ³ thá»ƒ cÃ³ nhiá»u bookings
   â”‚ Má»™t booking chá»‰ liÃªn quan Ä‘áº¿n má»™t room

bookings â”€(1:1)â”€â”€â”€ reviews
   â”‚ Má»™t booking cÃ³ thá»ƒ cÃ³ má»™t review
   â”‚ Má»™t review chá»‰ cho má»™t booking

bookings â”€(1:N)â”€â”€â”€ payments
   â”‚ Má»™t booking cÃ³ thá»ƒ cÃ³ nhiá»u payments
   â”‚ Má»™t payment chá»‰ cho má»™t booking

bookings â”€(N:M)â”€â”€â”€ services
   â”‚ Má»™t booking cÃ³ thá»ƒ cÃ³ nhiá»u services
   â”‚ Má»™t service cÃ³ thá»ƒ trong nhiá»u bookings
   â”‚ (ThÃ´ng qua báº£ng trung gian booking_services)

users â”€â”€â”€â”€â”€(1:1)â”€â”€â”€â”€â”€â”€ staff_profiles
   â”‚ Má»™t user (staff) cÃ³ má»™t profile
   â”‚ Má»™t staff_profile thuá»™c vá» má»™t user

users â”€â”€â”€â”€â”€(1:N)â”€â”€â”€â”€â”€â”€ work_shifts
   â”‚ Má»™t staff cÃ³ nhiá»u ca lÃ m
   â”‚ Má»™t ca lÃ m thuá»™c vá» má»™t staff

users â”€â”€â”€â”€â”€(1:N)â”€â”€â”€â”€â”€â”€ attendance_logs
   â”‚ Má»™t staff cÃ³ nhiá»u log cháº¥m cÃ´ng
   â”‚ Má»™t log thuá»™c vá» má»™t staff

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. CHI TIáº¾T CÃC Báº¢NG (TABLES)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.1. Báº¢NG USERS (NgÆ°á»i dÃ¹ng)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: LÆ°u trá»¯ thÃ´ng tin táº¥t cáº£ ngÆ°á»i dÃ¹ng trong há»‡ thá»‘ng

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ email          â•‘ VARCHAR(255)  â•‘ NO      â•‘ UNI   â•‘ Email (unique)          â•‘
â•‘ password       â•‘ VARCHAR(255)  â•‘ NO      â•‘       â•‘ Máº­t kháº©u Ä‘Ã£ hash        â•‘
â•‘ full_name      â•‘ VARCHAR(255)  â•‘ NO      â•‘       â•‘ Há» tÃªn Ä‘áº§y Ä‘á»§           â•‘
â•‘ phone          â•‘ VARCHAR(20)   â•‘ YES     â•‘       â•‘ Sá»‘ Ä‘iá»‡n thoáº¡i           â•‘
â•‘ date_of_birth  â•‘ DATE          â•‘ YES     â•‘       â•‘ NgÃ y sinh               â•‘
â•‘ nationality    â•‘ VARCHAR(100)  â•‘ YES     â•‘       â•‘ Quá»‘c tá»‹ch               â•‘
â•‘ id_number      â•‘ VARCHAR(50)   â•‘ YES     â•‘ IDX   â•‘ CMND/CCCD/Passport      â•‘
â•‘ address        â•‘ TEXT          â•‘ YES     â•‘       â•‘ Äá»‹a chá»‰                 â•‘
â•‘ role           â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ customer/staff/admin    â•‘
â•‘ avatar         â•‘ VARCHAR(255)  â•‘ YES     â•‘       â•‘ URL áº£nh Ä‘áº¡i diá»‡n        â•‘
â•‘ is_active      â•‘ BOOLEAN       â•‘ NO      â•‘ IDX   â•‘ Tráº¡ng thÃ¡i active       â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENUM Values:
   - role: 'customer', 'staff', 'admin'

Constraints:
   - PRIMARY KEY (id)
   - UNIQUE KEY (email)
   - CHECK (email LIKE '%@%.%')

Indexes:
   - idx_email (email)
   - idx_role (role)
   - idx_active (is_active)
   - idx_nationality (nationality)
   - idx_id_number (id_number)

Sample Data:
   Admin:    admin@homestay.com / Admin123
   Staff:    staff@homestay.com / Staff123
   Customer: customer@example.com / Customer123


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.2. Báº¢NG ROOMS (PhÃ²ng)                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: LÆ°u trá»¯ thÃ´ng tin cÃ¡c phÃ²ng trong homestay

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ room_number    â•‘ VARCHAR(20)   â•‘ NO      â•‘ UNI   â•‘ Sá»‘ phÃ²ng (unique)       â•‘
â•‘ room_type      â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ Loáº¡i phÃ²ng              â•‘
â•‘ name           â•‘ VARCHAR(255)  â•‘ YES     â•‘       â•‘ TÃªn phÃ²ng               â•‘
â•‘ capacity       â•‘ INT           â•‘ NO      â•‘       â•‘ Sá»©c chá»©a (sá»‘ ngÆ°á»i)     â•‘
â•‘ size           â•‘ DECIMAL(8,2)  â•‘ YES     â•‘       â•‘ Diá»‡n tÃ­ch (mÂ²)          â•‘
â•‘ floor          â•‘ INT           â•‘ YES     â•‘       â•‘ Táº§ng                    â•‘
â•‘ bed_type       â•‘ VARCHAR(100)  â•‘ YES     â•‘       â•‘ Loáº¡i giÆ°á»ng             â•‘
â•‘ price_per_     â•‘ DECIMAL(10,2) â•‘ NO      â•‘ IDX   â•‘ GiÃ¡ theo Ä‘Ãªm            â•‘
â•‘ night          â•‘               â•‘         â•‘       â•‘                         â•‘
â•‘ original_      â•‘ DECIMAL(10,2) â•‘ YES     â•‘       â•‘ GiÃ¡ gá»‘c (Ä‘á»ƒ tÃ­nh        â•‘
â•‘ price          â•‘               â•‘         â•‘       â•‘ discount)               â•‘
â•‘ description    â•‘ TEXT          â•‘ YES     â•‘       â•‘ MÃ´ táº£ phÃ²ng             â•‘
â•‘ amenities      â•‘ JSON          â•‘ YES     â•‘       â•‘ Tiá»‡n nghi (array)       â•‘
â•‘ images         â•‘ JSON          â•‘ YES     â•‘       â•‘ áº¢nh phÃ²ng (array URLs)  â•‘
â•‘ image_url      â•‘ VARCHAR(255)  â•‘ YES     â•‘       â•‘ áº¢nh chÃ­nh               â•‘
â•‘ status         â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ Tráº¡ng thÃ¡i phÃ²ng        â•‘
â•‘ rating         â•‘ DECIMAL(3,2)  â•‘ YES     â•‘       â•‘ ÄÃ¡nh giÃ¡ trung bÃ¬nh     â•‘
â•‘ review_count   â•‘ INT           â•‘ YES     â•‘       â•‘ Sá»‘ lÆ°á»£ng Ä‘Ã¡nh giÃ¡       â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENUM Values:
   - room_type: 'single', 'double', 'suite', 'family'
   - status: 'available', 'occupied', 'maintenance', 'cleaning'

JSON Fields:
   - amenities: ["WiFi", "TV", "Air Conditioning", "Mini Bar", ...]
   - images: ["/uploads/rooms/room1_1.jpg", "/uploads/rooms/room1_2.jpg", ...]

Constraints:
   - PRIMARY KEY (id)
   - UNIQUE KEY (room_number)
   - CHECK (capacity > 0)
   - CHECK (price_per_night > 0)
   - CHECK (rating BETWEEN 0 AND 5)

Indexes:
   - idx_room_number (room_number)
   - idx_room_type (room_type)
   - idx_status (status)
   - idx_price (price_per_night)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.3. Báº¢NG BOOKINGS (Äáº·t phÃ²ng)                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: LÆ°u trá»¯ thÃ´ng tin Ä‘áº·t phÃ²ng cá»§a khÃ¡ch hÃ ng

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ user_id        â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID khÃ¡ch hÃ ng           â•‘
â•‘ room_id        â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID phÃ²ng                â•‘
â•‘ check_in_date  â•‘ DATE          â•‘ NO      â•‘ IDX   â•‘ NgÃ y nháº­n phÃ²ng         â•‘
â•‘ check_out_date â•‘ DATE          â•‘ NO      â•‘ IDX   â•‘ NgÃ y tráº£ phÃ²ng          â•‘
â•‘ actual_check_  â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian check-in      â•‘
â•‘ in             â•‘               â•‘         â•‘       â•‘ thá»±c táº¿                 â•‘
â•‘ actual_check_  â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian check-out     â•‘
â•‘ out            â•‘               â•‘         â•‘       â•‘ thá»±c táº¿                 â•‘
â•‘ guests_count   â•‘ INT           â•‘ NO      â•‘       â•‘ Sá»‘ lÆ°á»£ng khÃ¡ch          â•‘
â•‘ total_amount   â•‘ DECIMAL(10,2) â•‘ NO      â•‘       â•‘ Tá»•ng tiá»n               â•‘
â•‘ status         â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ Tráº¡ng thÃ¡i booking      â•‘
â•‘ payment_status â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ Tráº¡ng thÃ¡i thanh toÃ¡n   â•‘
â•‘ special_       â•‘ TEXT          â•‘ YES     â•‘       â•‘ YÃªu cáº§u Ä‘áº·c biá»‡t        â•‘
â•‘ requests       â•‘               â•‘         â•‘       â•‘                         â•‘
â•‘ cancellation_  â•‘ TEXT          â•‘ YES     â•‘       â•‘ LÃ½ do há»§y               â•‘
â•‘ reason         â•‘               â•‘         â•‘       â•‘                         â•‘
â•‘ cancelled_at   â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian há»§y           â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENUM Values:
   - status: 'pending', 'confirmed', 'checked-in', 'checked-out', 
             'completed', 'cancelled'
   - payment_status: 'pending', 'paid', 'partially_paid', 'refunded', 'failed'

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
   - FOREIGN KEY (room_id) REFERENCES rooms(id) ON DELETE CASCADE
   - CHECK (check_out_date > check_in_date)
   - CHECK (guests_count > 0)
   - CHECK (total_amount >= 0)

Indexes:
   - idx_user_id (user_id)
   - idx_room_id (room_id)
   - idx_status (status)
   - idx_payment_status (payment_status)
   - idx_check_dates (check_in_date, check_out_date)
   - idx_created_at (created_at)

Business Rules:
   - KhÃ´ng thá»ƒ Ä‘áº·t phÃ²ng Ä‘Ã£ Ä‘Æ°á»£c booking trong cÃ¹ng khoáº£ng thá»i gian
   - Check-out date pháº£i sau check-in date
   - Sá»‘ khÃ¡ch khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ capacity cá»§a phÃ²ng


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.4. Báº¢NG PAYMENTS (Thanh toÃ¡n)                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: LÆ°u trá»¯ thÃ´ng tin thanh toÃ¡n

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ booking_id     â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID booking              â•‘
â•‘ customer_id    â•‘ INT           â•‘ YES     â•‘ FK    â•‘ ID khÃ¡ch hÃ ng           â•‘
â•‘ amount         â•‘ DECIMAL(10,2) â•‘ NO      â•‘       â•‘ Sá»‘ tiá»n thanh toÃ¡n      â•‘
â•‘ payment_method â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ PhÆ°Æ¡ng thá»©c TT          â•‘
â•‘ transaction_id â•‘ VARCHAR(255)  â•‘ YES     â•‘ IDX   â•‘ MÃ£ giao dá»‹ch tá»« gateway â•‘
â•‘ status         â•‘ ENUM          â•‘ NO      â•‘ IDX   â•‘ Tráº¡ng thÃ¡i TT           â•‘
â•‘ paid_at        â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian thanh toÃ¡n    â•‘
â•‘ refund_amount  â•‘ DECIMAL(10,2) â•‘ YES     â•‘       â•‘ Sá»‘ tiá»n hoÃ n láº¡i        â•‘
â•‘ refund_reason  â•‘ TEXT          â•‘ YES     â•‘       â•‘ LÃ½ do hoÃ n tiá»n         â•‘
â•‘ refunded_at    â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian hoÃ n tiá»n     â•‘
â•‘ notes          â•‘ TEXT          â•‘ YES     â•‘       â•‘ Ghi chÃº                 â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENUM Values:
   - payment_method: 'cash', 'card', 'vnpay', 'momo', 'bank_transfer'
   - status: 'pending', 'success', 'failed', 'refunded'

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (booking_id) REFERENCES bookings(id) ON DELETE CASCADE
   - FOREIGN KEY (customer_id) REFERENCES users(id) ON DELETE SET NULL
   - CHECK (amount > 0)

Indexes:
   - idx_booking_id (booking_id)
   - idx_customer_id (customer_id)
   - idx_payment_method (payment_method)
   - idx_status (status)
   - idx_transaction_id (transaction_id)
   - idx_paid_at (paid_at)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.5. Báº¢NG SERVICES (Dá»‹ch vá»¥)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: LÆ°u trá»¯ cÃ¡c dá»‹ch vá»¥ bá»• sung

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ name           â•‘ VARCHAR(255)  â•‘ NO      â•‘ IDX   â•‘ TÃªn dá»‹ch vá»¥             â•‘
â•‘ description    â•‘ TEXT          â•‘ YES     â•‘       â•‘ MÃ´ táº£ dá»‹ch vá»¥           â•‘
â•‘ price          â•‘ DECIMAL(10,2) â•‘ NO      â•‘ IDX   â•‘ GiÃ¡ dá»‹ch vá»¥             â•‘
â•‘ unit           â•‘ VARCHAR(50)   â•‘ YES     â•‘       â•‘ ÄÆ¡n vá»‹ (láº§n, ngÃ y, ...) â•‘
â•‘ category       â•‘ VARCHAR(50)   â•‘ YES     â•‘ IDX   â•‘ Danh má»¥c                â•‘
â•‘ icon           â•‘ VARCHAR(255)  â•‘ YES     â•‘       â•‘ Icon                    â•‘
â•‘ image_url      â•‘ VARCHAR(255)  â•‘ YES     â•‘       â•‘ HÃ¬nh áº£nh                â•‘
â•‘ is_active      â•‘ BOOLEAN       â•‘ NO      â•‘ IDX   â•‘ Tráº¡ng thÃ¡i active       â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Categories:
   - food: Äá»“ Äƒn, thá»©c uá»‘ng
   - transport: Váº­n chuyá»ƒn, Ä‘Æ°a Ä‘Ã³n
   - entertainment: Giáº£i trÃ­
   - spa: Spa, massage
   - laundry: Giáº·t á»§i
   - other: KhÃ¡c

Constraints:
   - PRIMARY KEY (id)
   - CHECK (price >= 0)

Indexes:
   - idx_name (name)
   - idx_category (category)
   - idx_active (is_active)
   - idx_price (price)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.6. Báº¢NG BOOKING_SERVICES (Dá»‹ch vá»¥ Ä‘áº·t kÃ¨m booking)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: Báº£ng trung gian liÃªn káº¿t bookings vÃ  services (N:M relationship)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ booking_id     â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID booking              â•‘
â•‘ service_id     â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID dá»‹ch vá»¥              â•‘
â•‘ quantity       â•‘ INT           â•‘ NO      â•‘       â•‘ Sá»‘ lÆ°á»£ng                â•‘
â•‘ unit_price     â•‘ DECIMAL(10,2) â•‘ NO      â•‘       â•‘ GiÃ¡ Ä‘Æ¡n vá»‹ táº¡i thá»i     â•‘
â•‘                â•‘               â•‘         â•‘       â•‘ Ä‘iá»ƒm Ä‘áº·t                â•‘
â•‘ total_price    â•‘ DECIMAL(10,2) â•‘ NO      â•‘       â•‘ Tá»•ng tiá»n (qty Ã— price) â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (booking_id) REFERENCES bookings(id) ON DELETE CASCADE
   - FOREIGN KEY (service_id) REFERENCES services(id) ON DELETE CASCADE
   - UNIQUE KEY unique_booking_service (booking_id, service_id)
   - CHECK (quantity > 0)
   - CHECK (unit_price >= 0)
   - CHECK (total_price >= 0)

Indexes:
   - idx_booking_id (booking_id)
   - idx_service_id (service_id)

Business Rules:
   - Má»™t booking khÃ´ng thá»ƒ cÃ³ cÃ¹ng service 2 láº§n (UNIQUE constraint)
   - LÆ°u unit_price táº¡i thá»i Ä‘iá»ƒm Ä‘áº·t Ä‘á»ƒ trÃ¡nh thay Ä‘á»•i giÃ¡ áº£nh hÆ°á»Ÿng


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.7. Báº¢NG REVIEWS (ÄÃ¡nh giÃ¡)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: LÆ°u trá»¯ Ä‘Ã¡nh giÃ¡ cá»§a khÃ¡ch hÃ ng vá» phÃ²ng

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ booking_id     â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID booking              â•‘
â•‘ user_id        â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID khÃ¡ch hÃ ng           â•‘
â•‘ room_id        â•‘ INT           â•‘ YES     â•‘ FK    â•‘ ID phÃ²ng                â•‘
â•‘ rating         â•‘ INT           â•‘ NO      â•‘ IDX   â•‘ ÄÃ¡nh giÃ¡ (1-5 sao)      â•‘
â•‘ comment        â•‘ TEXT          â•‘ YES     â•‘       â•‘ BÃ¬nh luáº­n               â•‘
â•‘ images         â•‘ JSON          â•‘ YES     â•‘       â•‘ áº¢nh Ä‘Ã¡nh giÃ¡            â•‘
â•‘ response       â•‘ TEXT          â•‘ YES     â•‘       â•‘ Pháº£n há»“i tá»« admin       â•‘
â•‘ responded_at   â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian pháº£n há»“i      â•‘
â•‘ status         â•‘ ENUM          â•‘ YES     â•‘       â•‘ Tráº¡ng thÃ¡i duyá»‡t        â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENUM Values:
   - status: 'pending', 'approved', 'rejected'

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (booking_id) REFERENCES bookings(id) ON DELETE CASCADE
   - FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
   - FOREIGN KEY (room_id) REFERENCES rooms(id) ON DELETE SET NULL
   - UNIQUE KEY unique_booking_review (booking_id)
   - CHECK (rating BETWEEN 1 AND 5)

Indexes:
   - idx_booking_id (booking_id)
   - idx_user_id (user_id)
   - idx_room_id (room_id)
   - idx_rating (rating)
   - idx_created_at (created_at)

Business Rules:
   - Má»™t booking chá»‰ cÃ³ má»™t review (UNIQUE constraint)
   - Chá»‰ cÃ³ thá»ƒ review khi booking status = 'completed'


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.8. Báº¢NG STAFF_PROFILES (Há»“ sÆ¡ nhÃ¢n viÃªn)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: ThÃ´ng tin chi tiáº¿t vá» nhÃ¢n viÃªn

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ user_id        â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID user (staff)         â•‘
â•‘ position       â•‘ VARCHAR(100)  â•‘ YES     â•‘       â•‘ Chá»©c vá»¥                 â•‘
â•‘ department     â•‘ VARCHAR(100)  â•‘ YES     â•‘       â•‘ PhÃ²ng ban               â•‘
â•‘ hire_date      â•‘ DATE          â•‘ YES     â•‘       â•‘ NgÃ y vÃ o lÃ m            â•‘
â•‘ salary         â•‘ DECIMAL(10,2) â•‘ YES     â•‘       â•‘ LÆ°Æ¡ng                   â•‘
â•‘ emergency_     â•‘ VARCHAR(255)  â•‘ YES     â•‘       â•‘ LiÃªn há»‡ kháº©n cáº¥p        â•‘
â•‘ contact        â•‘               â•‘         â•‘       â•‘                         â•‘
â•‘ notes          â•‘ TEXT          â•‘ YES     â•‘       â•‘ Ghi chÃº                 â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•‘ updated_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian cáº­p nháº­t      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
   - UNIQUE KEY unique_user_profile (user_id)

Indexes:
   - idx_user_id (user_id)
   - idx_position (position)
   - idx_department (department)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.9. Báº¢NG WORK_SHIFTS (Ca lÃ m viá»‡c)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: Quáº£n lÃ½ ca lÃ m viá»‡c cá»§a nhÃ¢n viÃªn

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ staff_id       â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID nhÃ¢n viÃªn            â•‘
â•‘ shift_date     â•‘ DATE          â•‘ NO      â•‘ IDX   â•‘ NgÃ y lÃ m viá»‡c           â•‘
â•‘ start_time     â•‘ TIME          â•‘ NO      â•‘       â•‘ Giá» báº¯t Ä‘áº§u             â•‘
â•‘ end_time       â•‘ TIME          â•‘ NO      â•‘       â•‘ Giá» káº¿t thÃºc            â•‘
â•‘ shift_type     â•‘ ENUM          â•‘ YES     â•‘       â•‘ Loáº¡i ca                 â•‘
â•‘ status         â•‘ ENUM          â•‘ YES     â•‘       â•‘ Tráº¡ng thÃ¡i ca           â•‘
â•‘ notes          â•‘ TEXT          â•‘ YES     â•‘       â•‘ Ghi chÃº                 â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENUM Values:
   - shift_type: 'morning', 'afternoon', 'evening', 'night', 'full_day'
   - status: 'scheduled', 'completed', 'absent', 'cancelled'

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (staff_id) REFERENCES users(id) ON DELETE CASCADE
   - CHECK (end_time > start_time)

Indexes:
   - idx_staff_id (staff_id)
   - idx_shift_date (shift_date)
   - idx_status (status)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.10. Báº¢NG ATTENDANCE_LOGS (Cháº¥m cÃ´ng)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: Ghi láº¡i thá»i gian cháº¥m cÃ´ng cá»§a nhÃ¢n viÃªn

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ staff_id       â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID nhÃ¢n viÃªn            â•‘
â•‘ check_in       â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian vÃ o           â•‘
â•‘ check_out      â•‘ DATETIME      â•‘ YES     â•‘       â•‘ Thá»i gian ra            â•‘
â•‘ work_hours     â•‘ DECIMAL(5,2)  â•‘ YES     â•‘       â•‘ Sá»‘ giá» lÃ m viá»‡c         â•‘
â•‘ notes          â•‘ TEXT          â•‘ YES     â•‘       â•‘ Ghi chÃº                 â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (staff_id) REFERENCES users(id) ON DELETE CASCADE

Indexes:
   - idx_staff_id (staff_id)
   - idx_check_in (check_in)
   - idx_created_at (created_at)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3.11. Báº¢NG STAFF_REPORTS (BÃ¡o cÃ¡o nhÃ¢n viÃªn)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MÃ´ táº£: BÃ¡o cÃ¡o cÃ´ng viá»‡c hÃ ng ngÃ y cá»§a nhÃ¢n viÃªn

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ COLUMN NAME    â•‘ DATA TYPE     â•‘ NULL    â•‘ KEY   â•‘ DESCRIPTION             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ id             â•‘ INT           â•‘ NO      â•‘ PK    â•‘ ID tá»± Ä‘á»™ng tÄƒng         â•‘
â•‘ staff_id       â•‘ INT           â•‘ NO      â•‘ FK    â•‘ ID nhÃ¢n viÃªn            â•‘
â•‘ report_date    â•‘ DATE          â•‘ NO      â•‘ IDX   â•‘ NgÃ y bÃ¡o cÃ¡o            â•‘
â•‘ checkins_count â•‘ INT           â•‘ YES     â•‘       â•‘ Sá»‘ lÆ°á»£ng check-in       â•‘
â•‘ checkouts_     â•‘ INT           â•‘ YES     â•‘       â•‘ Sá»‘ lÆ°á»£ng check-out      â•‘
â•‘ count          â•‘               â•‘         â•‘       â•‘                         â•‘
â•‘ total_revenue  â•‘ DECIMAL(10,2) â•‘ YES     â•‘       â•‘ Tá»•ng doanh thu          â•‘
â•‘ notes          â•‘ TEXT          â•‘ YES     â•‘       â•‘ Ghi chÃº                 â•‘
â•‘ created_at     â•‘ TIMESTAMP     â•‘ NO      â•‘       â•‘ Thá»i gian táº¡o           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Constraints:
   - PRIMARY KEY (id)
   - FOREIGN KEY (staff_id) REFERENCES users(id) ON DELETE CASCADE
   - UNIQUE KEY unique_staff_daily_report (staff_id, report_date)

Indexes:
   - idx_staff_id (staff_id)
   - idx_report_date (report_date)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. Má»I QUAN Há»† (RELATIONSHIPS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4.1. ONE-TO-MANY RELATIONSHIPS (1:N)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PARENT TABLE     â”‚ CHILD TABLE         â”‚ FOREIGN KEY                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ users            â”‚ bookings            â”‚ bookings.user_id â†’ users.id      â”‚
â”‚ users            â”‚ reviews             â”‚ reviews.user_id â†’ users.id       â”‚
â”‚ users            â”‚ staff_profiles      â”‚ staff_profiles.user_id â†’ users.idâ”‚
â”‚ users            â”‚ work_shifts         â”‚ work_shifts.staff_id â†’ users.id  â”‚
â”‚ users            â”‚ attendance_logs     â”‚ attendance_logs.staff_id â†’ u.id  â”‚
â”‚ users            â”‚ staff_reports       â”‚ staff_reports.staff_id â†’ users.idâ”‚
â”‚ rooms            â”‚ bookings            â”‚ bookings.room_id â†’ rooms.id      â”‚
â”‚ rooms            â”‚ reviews             â”‚ reviews.room_id â†’ rooms.id       â”‚
â”‚ bookings         â”‚ payments            â”‚ payments.booking_id â†’ bookings.idâ”‚
â”‚ bookings         â”‚ booking_services    â”‚ booking_services.booking_id â†’ ...|
â”‚ services         â”‚ booking_services    â”‚ booking_services.service_id â†’ ...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Giáº£i thÃ­ch:
   - Má»™t user (customer) cÃ³ thá»ƒ cÃ³ nhiá»u bookings
   - Má»™t room cÃ³ thá»ƒ cÃ³ nhiá»u bookings á»Ÿ cÃ¡c thá»i Ä‘iá»ƒm khÃ¡c nhau
   - Má»™t booking cÃ³ thá»ƒ cÃ³ nhiá»u payments (trÆ°á»ng há»£p thanh toÃ¡n nhiá»u láº§n)
   - Má»™t user (staff) cÃ³ nhiá»u ca lÃ m viá»‡c, nhiá»u log cháº¥m cÃ´ng


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4.2. ONE-TO-ONE RELATIONSHIPS (1:1)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TABLE 1          â”‚ TABLE 2             â”‚ RELATIONSHIP                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ users            â”‚ staff_profiles      â”‚ Má»™t staff cÃ³ má»™t profile         â”‚
â”‚ bookings         â”‚ reviews             â”‚ Má»™t booking cÃ³ má»™t review        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Giáº£i thÃ­ch:
   - Má»™t user vá»›i role='staff' cÃ³ má»™t staff_profile
   - Má»™t booking completed chá»‰ cÃ³ thá»ƒ cÃ³ má»™t review


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4.3. MANY-TO-MANY RELATIONSHIPS (N:M)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TABLE 1      â”‚ TABLE 2             â”‚ JUNCTION TABLE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ bookings     â”‚ services            â”‚ booking_services                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Giáº£i thÃ­ch:
   - Má»™t booking cÃ³ thá»ƒ cÃ³ nhiá»u services
   - Má»™t service cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong nhiá»u bookings
   - Báº£ng junction booking_services lÆ°u thÃ´ng tin liÃªn káº¿t vÃ  sá»‘ lÆ°á»£ng

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. INDEXES VÃ€ CONSTRAINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5.1. PRIMARY KEYS                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Táº¥t cáº£ cÃ¡c báº£ng Ä‘á»u cÃ³ PRIMARY KEY lÃ  cá»™t `id` kiá»ƒu INT AUTO_INCREMENT:
   - users.id
   - rooms.id
   - bookings.id
   - payments.id
   - services.id
   - booking_services.id
   - reviews.id
   - staff_profiles.id
   - work_shifts.id
   - attendance_logs.id
   - staff_reports.id

LÃ½ do: ÄÆ¡n giáº£n hÃ³a relationships vÃ  Ä‘áº£m báº£o uniqueness


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5.2. UNIQUE CONSTRAINTS                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TABLE             â•‘ COLUMN(S)             â•‘ PURPOSE                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ users             â•‘ email                 â•‘ Email khÃ´ng Ä‘Æ°á»£c trÃ¹ng         â•‘
â•‘ rooms             â•‘ room_number           â•‘ Sá»‘ phÃ²ng duy nháº¥t              â•‘
â•‘ booking_services  â•‘ (booking_id,          â•‘ TrÃ¡nh thÃªm service trÃ¹ng vÃ o   â•‘
â•‘                   â•‘  service_id)          â•‘ má»™t booking                    â•‘
â•‘ reviews           â•‘ booking_id            â•‘ Má»™t booking chá»‰ má»™t review     â•‘
â•‘ staff_profiles    â•‘ user_id               â•‘ Má»™t user chá»‰ má»™t profile       â•‘
â•‘ staff_reports     â•‘ (staff_id,            â•‘ Má»™t staff má»™t bÃ¡o cÃ¡o má»—i ngÃ y â•‘
â•‘                   â•‘  report_date)         â•‘                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5.3. FOREIGN KEY CONSTRAINTS                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ FOREIGN KEY      â•‘ REFERENCES            â•‘ ON DELETE                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ bookings.user_id â•‘ users.id              â•‘ CASCADE (xÃ³a user â†’ xÃ³a booking) â•‘
â•‘ bookings.room_id â•‘ rooms.id              â•‘ CASCADE (xÃ³a room â†’ xÃ³a booking) â•‘
â•‘ payments.        â•‘ bookings.id           â•‘ CASCADE                          â•‘
â•‘ booking_id       â•‘                       â•‘                                  â•‘
â•‘ payments.        â•‘ users.id              â•‘ SET NULL                         â•‘
â•‘ customer_id      â•‘                       â•‘                                  â•‘
â•‘ reviews.         â•‘ bookings.id           â•‘ CASCADE                          â•‘
â•‘ booking_id       â•‘                       â•‘                                  â•‘
â•‘ reviews.user_id  â•‘ users.id              â•‘ CASCADE                          â•‘
â•‘ reviews.room_id  â•‘ rooms.id              â•‘ SET NULL                         â•‘
â•‘ booking_services â•‘ bookings.id           â•‘ CASCADE                          â•‘
â•‘ .booking_id      â•‘                       â•‘                                  â•‘
â•‘ booking_services â•‘ services.id           â•‘ CASCADE                          â•‘
â•‘ .service_id      â•‘                       â•‘                                  â•‘
â•‘ staff_profiles.  â•‘ users.id              â•‘ CASCADE                          â•‘
â•‘ user_id          â•‘                       â•‘                                  â•‘
â•‘ work_shifts.     â•‘ users.id              â•‘ CASCADE                          â•‘
â•‘ staff_id         â•‘                       â•‘                                  â•‘
â•‘ attendance_logs. â•‘ users.id              â•‘ CASCADE                          â•‘
â•‘ staff_id         â•‘                       â•‘                                  â•‘
â•‘ staff_reports.   â•‘ users.id              â•‘ CASCADE                          â•‘
â•‘ staff_id         â•‘                       â•‘                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CASCADE: Khi xÃ³a parent record, tá»± Ä‘á»™ng xÃ³a child records
SET NULL: Khi xÃ³a parent record, set foreign key cá»§a child thÃ nh NULL


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5.4. CHECK CONSTRAINTS                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TABLE             â•‘ CHECK CONSTRAINT                                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ users             â•‘ email LIKE '%@%.%'                                      â•‘
â•‘ rooms             â•‘ capacity > 0                                            â•‘
â•‘ rooms             â•‘ price_per_night > 0                                     â•‘
â•‘ rooms             â•‘ rating BETWEEN 0 AND 5                                  â•‘
â•‘ bookings          â•‘ check_out_date > check_in_date                          â•‘
â•‘ bookings          â•‘ guests_count > 0                                        â•‘
â•‘ bookings          â•‘ total_amount >= 0                                       â•‘
â•‘ payments          â•‘ amount > 0                                              â•‘
â•‘ services          â•‘ price >= 0                                              â•‘
â•‘ booking_services  â•‘ quantity > 0                                            â•‘
â•‘ booking_services  â•‘ unit_price >= 0                                         â•‘
â•‘ booking_services  â•‘ total_price >= 0                                        â•‘
â•‘ reviews           â•‘ rating BETWEEN 1 AND 5                                  â•‘
â•‘ work_shifts       â•‘ end_time > start_time                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5.5. INDEXES (Performance Optimization)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TABLE             â•‘ INDEX NAME              â•‘ COLUMNS                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ users             â•‘ idx_email               â•‘ email                          â•‘
â•‘                   â•‘ idx_role                â•‘ role                           â•‘
â•‘                   â•‘ idx_active              â•‘ is_active                      â•‘
â•‘                   â•‘ idx_id_number           â•‘ id_number                      â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ rooms             â•‘ idx_room_number         â•‘ room_number                    â•‘
â•‘                   â•‘ idx_room_type           â•‘ room_type                      â•‘
â•‘                   â•‘ idx_status              â•‘ status                         â•‘
â•‘                   â•‘ idx_price               â•‘ price_per_night                â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ bookings          â•‘ idx_user_id             â•‘ user_id                        â•‘
â•‘                   â•‘ idx_room_id             â•‘ room_id                        â•‘
â•‘                   â•‘ idx_status              â•‘ status                         â•‘
â•‘                   â•‘ idx_payment_status      â•‘ payment_status                 â•‘
â•‘                   â•‘ idx_check_dates         â•‘ (check_in_date,check_out_date) â•‘
â•‘                   â•‘ idx_created_at          â•‘ created_at                     â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ payments          â•‘ idx_booking_id          â•‘ booking_id                     â•‘
â•‘                   â•‘ idx_customer_id         â•‘ customer_id                    â•‘
â•‘                   â•‘ idx_payment_method      â•‘ payment_method                 â•‘
â•‘                   â•‘ idx_status              â•‘ status                         â•‘
â•‘                   â•‘ idx_transaction_id      â•‘ transaction_id                 â•‘
â•‘                   â•‘ idx_paid_at             â•‘ paid_at                        â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ services          â•‘ idx_name                â•‘ name                           â•‘
â•‘                   â•‘ idx_category            â•‘ category                       â•‘
â•‘                   â•‘ idx_active              â•‘ is_active                      â•‘
â•‘                   â•‘ idx_price               â•‘ price                          â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ booking_services  â•‘ idx_booking_id          â•‘ booking_id                     â•‘
â•‘                   â•‘ idx_service_id          â•‘ service_id                     â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ reviews           â•‘ idx_booking_id          â•‘ booking_id                     â•‘
â•‘                   â•‘ idx_user_id             â•‘ user_id                        â•‘
â•‘                   â•‘ idx_room_id             â•‘ room_id                        â•‘
â•‘                   â•‘ idx_rating              â•‘ rating                         â•‘
â•‘                   â•‘ idx_created_at          â•‘ created_at                     â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ staff_profiles    â•‘ idx_user_id             â•‘ user_id                        â•‘
â•‘                   â•‘ idx_position            â•‘ position                       â•‘
â•‘                   â•‘ idx_department          â•‘ department                     â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ work_shifts       â•‘ idx_staff_id            â•‘ staff_id                       â•‘
â•‘                   â•‘ idx_shift_date          â•‘ shift_date                     â•‘
â•‘                   â•‘ idx_status              â•‘ status                         â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ attendance_logs   â•‘ idx_staff_id            â•‘ staff_id                       â•‘
â•‘                   â•‘ idx_check_in            â•‘ check_in                       â•‘
â•‘                   â•‘ idx_created_at          â•‘ created_at                     â•‘
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ staff_reports     â•‘ idx_staff_id            â•‘ staff_id                       â•‘
â•‘                   â•‘ idx_report_date         â•‘ report_date                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LÃ½ do táº¡o indexes:
   âœ“ TÄƒng tá»‘c Ä‘á»™ query khi WHERE, JOIN
   âœ“ Tá»‘i Æ°u ORDER BY, GROUP BY
   âœ“ Há»— trá»£ cÃ¡c truy váº¥n phá»• biáº¿n cá»§a application

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. VIEWS (CÃC KHUNG NHÃŒN)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Views lÃ  virtual tables giÃºp Ä‘Æ¡n giáº£n hÃ³a cÃ¡c truy váº¥n phá»©c táº¡p


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6.1. VIEW: room_occupancy_stats                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: Thá»‘ng kÃª tÃ¬nh tráº¡ng sá»­ dá»¥ng cá»§a tá»«ng phÃ²ng

Äá»‹nh nghÄ©a:
   CREATE VIEW room_occupancy_stats AS
   SELECT 
       r.id,
       r.room_number,
       r.room_type,
       COUNT(b.id) as total_bookings,
       SUM(CASE WHEN b.status IN ('confirmed', 'checked-in', 
                                   'checked-out', 'completed') 
                THEN 1 ELSE 0 END) as successful_bookings,
       AVG(b.total_amount) as avg_booking_amount,
       MAX(b.created_at) as last_booking_date
   FROM rooms r
   LEFT JOIN bookings b ON r.id = b.room_id
   GROUP BY r.id, r.room_number, r.room_type;

CÃ¡ch sá»­ dá»¥ng:
   SELECT * FROM room_occupancy_stats WHERE total_bookings > 10;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6.2. VIEW: monthly_revenue                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: BÃ¡o cÃ¡o doanh thu theo thÃ¡ng

Äá»‹nh nghÄ©a:
   CREATE VIEW monthly_revenue AS
   SELECT 
       YEAR(p.paid_at) as year,
       MONTH(p.paid_at) as month,
       COUNT(p.id) as total_payments,
       SUM(p.amount) as total_revenue,
       AVG(p.amount) as avg_payment_amount
   FROM payments p
   WHERE p.status = 'success'
   GROUP BY YEAR(p.paid_at), MONTH(p.paid_at)
   ORDER BY year DESC, month DESC;

CÃ¡ch sá»­ dá»¥ng:
   SELECT * FROM monthly_revenue WHERE year = 2025;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6.3. VIEW: customer_booking_summary                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: TÃ³m táº¯t lá»‹ch sá»­ booking cá»§a khÃ¡ch hÃ ng

Äá»‹nh nghÄ©a:
   CREATE VIEW customer_booking_summary AS
   SELECT 
       u.id as user_id,
       u.full_name,
       u.email,
       COUNT(b.id) as total_bookings,
       SUM(b.total_amount) as total_spent,
       AVG(r.rating) as avg_rating_given,
       MAX(b.created_at) as last_booking_date,
       MIN(b.created_at) as first_booking_date
   FROM users u
   LEFT JOIN bookings b ON u.id = b.user_id
   LEFT JOIN reviews r ON b.id = r.booking_id
   WHERE u.role = 'customer'
   GROUP BY u.id, u.full_name, u.email;

CÃ¡ch sá»­ dá»¥ng:
   SELECT * FROM customer_booking_summary 
   WHERE total_spent > 5000000 
   ORDER BY total_spent DESC;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7. STORED PROCEDURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Stored Procedures lÃ  cÃ¡c Ä‘oáº¡n code SQL Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  tÃ¡i sá»­ dá»¥ng


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7.1. PROCEDURE: GetAvailableRooms                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: TÃ¬m cÃ¡c phÃ²ng trá»‘ng trong khoáº£ng thá»i gian

Parameters:
   - IN check_in DATE: NgÃ y check-in
   - IN check_out DATE: NgÃ y check-out
   - IN room_type_filter VARCHAR(20): Lá»c theo loáº¡i phÃ²ng (optional)

Äá»‹nh nghÄ©a:
   DELIMITER //
   CREATE PROCEDURE GetAvailableRooms(
       IN check_in DATE,
       IN check_out DATE,
       IN room_type_filter VARCHAR(20)
   )
   BEGIN
       SELECT r.*
       FROM rooms r
       WHERE r.status = 'available'
       AND (room_type_filter IS NULL OR r.room_type = room_type_filter)
       AND r.id NOT IN (
           SELECT DISTINCT room_id 
           FROM bookings 
           WHERE status IN ('confirmed', 'checked-in')
           AND (
               (check_in_date <= check_in AND check_out_date > check_in)
               OR (check_in_date < check_out AND check_out_date >= check_out)
               OR (check_in_date >= check_in AND check_out_date <= check_out)
           )
       )
       ORDER BY r.price_per_night ASC;
   END //
   DELIMITER ;

CÃ¡ch sá»­ dá»¥ng:
   CALL GetAvailableRooms('2025-10-15', '2025-10-20', 'suite');
   CALL GetAvailableRooms('2025-10-15', '2025-10-20', NULL);


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7.2. PROCEDURE: CalculateBookingTotal                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: TÃ­nh tá»•ng tiá»n booking bao gá»“m phÃ²ng + dá»‹ch vá»¥

Parameters:
   - IN booking_id_param INT: ID cá»§a booking
   - OUT total_amount DECIMAL(10,2): Tá»•ng tiá»n (output)

Äá»‹nh nghÄ©a:
   DELIMITER //
   CREATE PROCEDURE CalculateBookingTotal(
       IN booking_id_param INT,
       OUT total_amount DECIMAL(10,2)
   )
   BEGIN
       DECLARE room_cost DECIMAL(10,2) DEFAULT 0;
       DECLARE service_cost DECIMAL(10,2) DEFAULT 0;
       
       -- TÃ­nh tiá»n phÃ²ng
       SELECT 
           DATEDIFF(b.check_out_date, b.check_in_date) * r.price_per_night
       INTO room_cost
       FROM bookings b
       JOIN rooms r ON b.room_id = r.id
       WHERE b.id = booking_id_param;
       
       -- TÃ­nh tiá»n dá»‹ch vá»¥
       SELECT COALESCE(SUM(bs.total_price), 0)
       INTO service_cost
       FROM booking_services bs
       WHERE bs.booking_id = booking_id_param;
       
       SET total_amount = room_cost + service_cost;
   END //
   DELIMITER ;

CÃ¡ch sá»­ dá»¥ng:
   CALL CalculateBookingTotal(1, @total);
   SELECT @total;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7.3. PROCEDURE: GenerateMonthlyReport                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: Táº¡o bÃ¡o cÃ¡o thÃ¡ng

Parameters:
   - IN target_month INT
   - IN target_year INT

Äá»‹nh nghÄ©a:
   DELIMITER //
   CREATE PROCEDURE GenerateMonthlyReport(
       IN target_month INT,
       IN target_year INT
   )
   BEGIN
       SELECT 
           COUNT(DISTINCT b.id) as total_bookings,
           COUNT(DISTINCT b.user_id) as unique_customers,
           SUM(p.amount) as total_revenue,
           AVG(p.amount) as avg_booking_value,
           COUNT(DISTINCT CASE WHEN b.status = 'completed' 
                          THEN b.id END) as completed_bookings,
           COUNT(DISTINCT CASE WHEN b.status = 'cancelled' 
                          THEN b.id END) as cancelled_bookings
       FROM bookings b
       LEFT JOIN payments p ON b.id = p.booking_id AND p.status = 'success'
       WHERE MONTH(b.created_at) = target_month
       AND YEAR(b.created_at) = target_year;
   END //
   DELIMITER ;

CÃ¡ch sá»­ dá»¥ng:
   CALL GenerateMonthlyReport(10, 2025);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8. TRIGGERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Triggers tá»± Ä‘á»™ng thá»±c hiá»‡n khi cÃ³ sá»± kiá»‡n INSERT, UPDATE, DELETE


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8.1. TRIGGER: update_room_status_on_booking                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: Tá»± Ä‘á»™ng cáº­p nháº­t tráº¡ng thÃ¡i phÃ²ng khi booking thay Ä‘á»•i

Sá»± kiá»‡n: AFTER UPDATE ON bookings

Logic:
   - Khi booking chuyá»ƒn sang 'checked-in' â†’ room status = 'occupied'
   - Khi booking chuyá»ƒn sang 'checked-out' â†’ room status = 'available'
   - Khi booking bá»‹ 'cancelled' â†’ room status = 'available'

Äá»‹nh nghÄ©a:
   DELIMITER //
   CREATE TRIGGER update_room_status_on_booking
   AFTER UPDATE ON bookings
   FOR EACH ROW
   BEGIN
       IF NEW.status = 'checked-in' AND OLD.status != 'checked-in' THEN
           UPDATE rooms SET status = 'occupied' WHERE id = NEW.room_id;
       ELSEIF NEW.status = 'checked-out' AND OLD.status != 'checked-out' THEN
           UPDATE rooms SET status = 'available' WHERE id = NEW.room_id;
       ELSEIF NEW.status = 'cancelled' AND OLD.status != 'cancelled' THEN
           UPDATE rooms SET status = 'available' WHERE id = NEW.room_id;
       END IF;
   END //
   DELIMITER ;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8.2. TRIGGER: update_room_rating_on_review                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Má»¥c Ä‘Ã­ch: Tá»± Ä‘á»™ng cáº­p nháº­t rating trung bÃ¬nh cá»§a phÃ²ng khi cÃ³ review má»›i

Sá»± kiá»‡n: AFTER INSERT ON reviews

Äá»‹nh nghÄ©a:
   DELIMITER //
   CREATE TRIGGER update_room_rating_on_review
   AFTER INSERT ON reviews
   FOR EACH ROW
   BEGIN
       UPDATE rooms r
       SET 
           r.rating = (
               SELECT AVG(rv.rating)
               FROM reviews rv
               JOIN bookings b ON rv.booking_id = b.id
               WHERE b.room_id = r.id
           ),
           r.review_count = (
               SELECT COUNT(*)
               FROM reviews rv
               JOIN bookings b ON rv.booking_id = b.id
               WHERE b.room_id = r.id
           )
       WHERE r.id = (
           SELECT room_id FROM bookings WHERE id = NEW.booking_id
       );
   END //
   DELIMITER ;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
9. QUERIES QUAN TRá»ŒNG
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CÃ¡c query SQL thÆ°á»ng dÃ¹ng trong há»‡ thá»‘ng


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9.1. TÃ¬m phÃ²ng trá»‘ng theo ngÃ y                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SELECT r.*
FROM rooms r
WHERE r.status = 'available'
AND r.id NOT IN (
    SELECT DISTINCT room_id 
    FROM bookings 
    WHERE status IN ('confirmed', 'checked-in')
    AND (
        (check_in_date <= '2025-10-15' AND check_out_date > '2025-10-15')
        OR (check_in_date < '2025-10-20' AND check_out_date >= '2025-10-20')
        OR (check_in_date >= '2025-10-15' AND check_out_date <= '2025-10-20')
    )
)
ORDER BY price_per_night ASC;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9.2. Láº¥y booking vá»›i Ä‘áº§y Ä‘á»§ thÃ´ng tin                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SELECT 
    b.id,
    b.check_in_date,
    b.check_out_date,
    b.guests_count,
    b.total_amount,
    b.status,
    b.payment_status,
    u.full_name as customer_name,
    u.email as customer_email,
    u.phone as customer_phone,
    r.room_number,
    r.room_type,
    r.name as room_name,
    r.price_per_night,
    GROUP_CONCAT(s.name SEPARATOR ', ') as services
FROM bookings b
JOIN users u ON b.user_id = u.id
JOIN rooms r ON b.room_id = r.id
LEFT JOIN booking_services bs ON b.id = bs.booking_id
LEFT JOIN services s ON bs.service_id = s.id
WHERE b.id = ?
GROUP BY b.id;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9.3. Thá»‘ng kÃª doanh thu theo thÃ¡ng                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SELECT 
    DATE_FORMAT(p.paid_at, '%Y-%m') as month,
    COUNT(DISTINCT b.id) as total_bookings,
    SUM(p.amount) as total_revenue,
    AVG(p.amount) as avg_booking_value,
    COUNT(DISTINCT b.room_id) as rooms_used
FROM payments p
JOIN bookings b ON p.booking_id = b.id
WHERE p.status = 'success'
AND p.paid_at BETWEEN '2025-01-01' AND '2025-12-31'
GROUP BY DATE_FORMAT(p.paid_at, '%Y-%m')
ORDER BY month DESC;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9.4. Top khÃ¡ch hÃ ng theo doanh thu                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SELECT 
    u.id,
    u.full_name,
    u.email,
    COUNT(b.id) as total_bookings,
    SUM(b.total_amount) as total_spent,
    AVG(b.total_amount) as avg_booking_value,
    MAX(b.created_at) as last_booking
FROM users u
JOIN bookings b ON u.id = b.user_id
WHERE u.role = 'customer'
AND b.status IN ('confirmed', 'checked-in', 'checked-out', 'completed')
GROUP BY u.id
ORDER BY total_spent DESC
LIMIT 10;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9.5. Tá»· lá»‡ láº¥p Ä‘áº§y phÃ²ng                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SELECT 
    DATE_FORMAT(b.check_in_date, '%Y-%m') as month,
    COUNT(DISTINCT b.room_id) as rooms_booked,
    (SELECT COUNT(*) FROM rooms WHERE status != 'maintenance') as total_rooms,
    SUM(DATEDIFF(b.check_out_date, b.check_in_date)) as total_nights,
    ROUND(
        (SUM(DATEDIFF(b.check_out_date, b.check_in_date)) / 
         ((SELECT COUNT(*) FROM rooms) * DAY(LAST_DAY(b.check_in_date)))) * 100,
        2
    ) as occupancy_rate
FROM bookings b
WHERE b.status IN ('confirmed', 'checked-in', 'checked-out', 'completed')
AND b.check_in_date >= '2025-01-01'
GROUP BY DATE_FORMAT(b.check_in_date, '%Y-%m')
ORDER BY month DESC;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9.6. Reviews cá»§a phÃ²ng vá»›i thÃ´ng tin khÃ¡ch                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SELECT 
    r.id,
    r.rating,
    r.comment,
    r.created_at,
    u.full_name as customer_name,
    u.avatar as customer_avatar,
    b.check_in_date,
    b.check_out_date
FROM reviews r
JOIN users u ON r.user_id = u.id
JOIN bookings b ON r.booking_id = b.id
WHERE b.room_id = ?
ORDER BY r.created_at DESC;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
10. OPTIMIZATION VÃ€ BEST PRACTICES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10.1. Database Optimization Tips                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Indexing Strategy:
   - Táº¡o index cho foreign keys
   - Táº¡o index cho columns thÆ°á»ng dÃ¹ng trong WHERE, JOIN, ORDER BY
   - Táº¡o composite index cho queries thÆ°á»ng join nhiá»u columns
   - TrÃ¡nh over-indexing (lÃ m cháº­m INSERT, UPDATE)

âœ… Query Optimization:
   - Sá»­ dá»¥ng EXPLAIN Ä‘á»ƒ phÃ¢n tÃ­ch query
   - TrÃ¡nh SELECT *, chá»‰ láº¥y columns cáº§n thiáº¿t
   - Sá»­ dá»¥ng LIMIT khi khÃ´ng cáº§n táº¥t cáº£ records
   - Sá»­ dá»¥ng JOIN thay vÃ¬ subqueries khi cÃ³ thá»ƒ
   - Cache cÃ¡c queries hay dÃ¹ng

âœ… Data Types:
   - DÃ¹ng INT cho IDs (nhá» hÆ¡n VARCHAR)
   - DÃ¹ng ENUM cho columns cÃ³ giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh
   - DÃ¹ng DECIMAL cho tiá»n tá»‡ (trÃ¡nh floating point errors)
   - DÃ¹ng JSON cho data linh hoáº¡t (MySQL 5.7+)
   - DÃ¹ng DATE/DATETIME Ä‘Ãºng má»¥c Ä‘Ã­ch

âœ… Normalization:
   - TuÃ¢n thá»§ 3NF (Third Normal Form)
   - TrÃ¡nh duplicate data
   - Sá»­ dá»¥ng junction tables cho many-to-many relationships
   - Denormalize cÃ³ chá»n lá»c khi cáº§n performance

âœ… Transactions:
   - Sá»­ dá»¥ng transactions cho operations liÃªn quan nhiá»u tables
   - Äáº£m báº£o ACID properties
   - Rollback khi cÃ³ lá»—i

âœ… Security:
   - Sá»­ dá»¥ng prepared statements (é˜²SQL injection)
   - Hash passwords vá»›i bcrypt
   - KhÃ´ng lÆ°u sensitive data dáº¡ng plain text
   - Sá»­ dá»¥ng SSL/TLS cho connections
   - Regular backups


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10.2. Backup vÃ  Recovery                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¦ Backup Strategy:
   - Daily automated backups
   - Weekly full backups
   - Monthly archived backups
   - Store backups offsite (cloud storage)

Backup command:
   mysqldump -u root -p homestay_db > backup_$(date +%Y%m%d).sql

Restore command:
   mysql -u root -p homestay_db < backup_20251011.sql


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10.3. Monitoring                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š Metrics to Monitor:
   - Query execution time
   - Slow query log
   - Connection pool usage
   - Table sizes
   - Index usage
   - Deadlocks
   - Replication lag (if using replication)

Enable slow query log:
   SET GLOBAL slow_query_log = 'ON';
   SET GLOBAL long_query_time = 2; -- queries > 2 seconds


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10.4. Scaling Strategy                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸš€ Vertical Scaling:
   - TÄƒng RAM
   - TÄƒng CPU
   - Sá»­ dá»¥ng SSD

ğŸ”€ Horizontal Scaling:
   - Master-Slave Replication
   - Read replicas cho read-heavy workloads
   - Sharding (phÃ¢n chia data)

ğŸ’¾ Caching:
   - Redis/Memcached cho session data
   - Application-level caching
   - Query result caching

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Káº¾T LUáº¬N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ TÃ³m táº¯t thiáº¿t káº¿:
   - Database Ä‘Æ°á»£c thiáº¿t káº¿ normalized, tá»‘i Æ°u cho há»‡ thá»‘ng quáº£n lÃ½ homestay
   - 11 tables chÃ­nh vá»›i relationships rÃµ rÃ ng
   - Äáº§y Ä‘á»§ constraints, indexes Ä‘á»ƒ Ä‘áº£m báº£o data integrity vÃ  performance
   - Views, Stored Procedures, Triggers Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a business logic
   - Scalable vÃ  maintainable

ğŸ”§ Files liÃªn quan:
   - /database/schema.sql - Database schema
   - /database/seed.sql - Sample data
   - /database/complete_database.sql - Full database vá»›i data

ğŸ“š TÃ i liá»‡u tham kháº£o:
   - MySQL 8.0 Reference Manual
   - Database Design Best Practices
   - SQL Performance Tuning

ğŸ“… Cáº­p nháº­t láº§n cuá»‘i: 2025-10-11
ğŸ“§ LiÃªn há»‡: support@homestay.com

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


